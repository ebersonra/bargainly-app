<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barganha App - Encontre os Melhores Pre√ßos</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <div class="page-header">
            <h1>Bem-vindo ao Barganha App</h1>
            <p>Encontre os melhores pre√ßos e economize nas suas compras</p>
        </div>

        <div class="page-content">
            <!-- Quick Actions -->
            <div class="card mb-8">
                <div class="card-header">
                    <h2>A√ß√µes R√°pidas</h2>
                </div>
                <div class="card-body">
                    <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
                        <a href="/purchase.html" class="quick-action-card">
                            <div class="quick-action-icon">üìù</div>
                            <h3>Registrar Compra</h3>
                            <p>Registre uma nova compra rapidamente</p>
                        </a>
                        <a href="/deals.html" class="quick-action-card">
                            <div class="quick-action-icon">üî•</div>
                            <h3>Ver Ofertas</h3>
                            <p>Encontre as melhores ofertas dispon√≠veis</p>
                        </a>
                        <a href="/goals.html" class="quick-action-card">
                            <div class="quick-action-icon">üéØ</div>
                            <h3>Minhas Metas</h3>
                            <p>Acompanhe suas metas de or√ßamento</p>
                        </a>
                        <a href="/products.html" class="quick-action-card">
                            <div class="quick-action-icon">üì¶</div>
                            <h3>Produtos</h3>
                            <p>Cadastre e gerencie produtos</p>
                        </a>
                        <a href="/markets.html" class="quick-action-card">
                            <div class="quick-action-icon">üè™</div>
                            <h3>Mercados</h3>
                            <p>Gerencie seus mercados favoritos</p>
                        </a>
                        <a href="/dashboard.html" class="quick-action-card">
                            <div class="quick-action-icon">üìä</div>
                            <h3>Dashboard</h3>
                            <p>Veja relat√≥rios e estat√≠sticas</p>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Recent Activity Summary -->
            <div class="grid gap-6 lg:grid-cols-2">
                <!-- Recent Purchases -->
                <div class="card">
                    <div class="card-header">
                        <h3>√öltimas Compras</h3>
                        <a href="/purchase.html" class="text-sm text-primary-600 hover:text-primary-700">Ver todas</a>
                    </div>
                    <div class="card-body">
                        <div id="homeRecentPurchases">
                            <div class="empty-state-sm">
                                <span>üõí</span>
                                <p>Nenhuma compra recente</p>
                                <a href="/purchase.html" class="btn btn-primary btn-sm mt-3">Registrar primeira compra</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Best Deals -->
                <div class="card">
                    <div class="card-header">
                        <h3>Ofertas em Destaque</h3>
                        <a href="/deals.html" class="text-sm text-primary-600 hover:text-primary-700">Ver todas</a>
                    </div>
                    <div class="card-body">
                        <div id="homeBestDeals">
                            <div class="empty-state-sm">
                                <span>üî•</span>
                                <p>Nenhuma oferta dispon√≠vel</p>
                                <a href="/products.html" class="btn btn-primary btn-sm mt-3">Cadastrar produtos</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Getting Started Guide -->
            <div class="card mt-8" id="gettingStartedCard">
                <div class="card-header">
                    <h3>Como come√ßar</h3>
                </div>
                <div class="card-body">
                    <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-4">
                        <div class="step-card">
                            <div class="step-number">1</div>
                            <h4>Cadastre Mercados</h4>
                            <p>Adicione os mercados onde voc√™ costuma fazer compras</p>
                            <a href="/markets.html" class="btn btn-secondary btn-sm mt-2">Cadastrar</a>
                        </div>
                        <div class="step-card">
                            <div class="step-number">2</div>
                            <h4>Adicione Produtos</h4>
                            <p>Cadastre produtos com seus pre√ßos em diferentes mercados</p>
                            <a href="/products.html" class="btn btn-secondary btn-sm mt-2">Adicionar</a>
                        </div>
                        <div class="step-card">
                            <div class="step-number">3</div>
                            <h4>Defina Metas</h4>
                            <p>Estabele√ßa metas de or√ßamento para controlar seus gastos</p>
                            <a href="/goals.html" class="btn btn-secondary btn-sm mt-2">Definir</a>
                        </div>
                        <div class="step-card">
                            <div class="step-number">4</div>
                            <h4>Registre Compras</h4>
                            <p>Acompanhe seus gastos registrando suas compras</p>
                            <a href="/purchase.html" class="btn btn-secondary btn-sm mt-2">Registrar</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="/static/js/mvc/components/Navigation.js"></script>
    <script src="/static/js/mvc/controllers/BaseController.js"></script>
    <script src="/static/js/auth.js"></script>
    <script src="/static/js/utils.js"></script>
    <script src="/static/js/bargainly-app.js"></script>

    <script>
        // Home page controller
        class HomeController extends BaseController {
            constructor() {
                super();
                this.init();
            }

            init() {
                this.loadHomeData();
                this.checkFirstTime();
            }

            async loadHomeData() {
                try {
                    await Promise.all([
                        this.loadRecentPurchases(),
                        this.loadBestDeals()
                    ]);
                } catch (error) {
                    console.error('Erro ao carregar dados da home:', error);
                }
            }

            async loadRecentPurchases() {
                const container = document.getElementById('homeRecentPurchases');
                
                try {
                    // Simulate recent purchases for demo
                    const purchases = []; // Empty for first time

                    if (purchases.length === 0) {
                        container.innerHTML = `
                            <div class="empty-state-sm">
                                <span>üõí</span>
                                <p>Nenhuma compra recente</p>
                                <a href="/purchase.html" class="btn btn-primary btn-sm mt-3">Registrar primeira compra</a>
                            </div>
                        `;
                        return;
                    }

                    // Display purchases...
                } catch (error) {
                    container.innerHTML = '<p class="text-error-600 text-sm">Erro ao carregar compras</p>';
                }
            }

            async loadBestDeals() {
                const container = document.getElementById('homeBestDeals');
                
                try {
                    // Simulate best deals for demo
                    const deals = []; // Empty for first time

                    if (deals.length === 0) {
                        container.innerHTML = `
                            <div class="empty-state-sm">
                                <span>üî•</span>
                                <p>Nenhuma oferta dispon√≠vel</p>
                                <a href="/products.html" class="btn btn-primary btn-sm mt-3">Cadastrar produtos</a>
                            </div>
                        `;
                        return;
                    }

                    // Display deals...
                } catch (error) {
                    container.innerHTML = '<p class="text-error-600 text-sm">Erro ao carregar ofertas</p>';
                }
            }

            checkFirstTime() {
                // Check if user has any data and show/hide getting started guide
                const userId = this.getUserIdFromCookie();
                if (userId) {
                    // For now, always show the getting started guide
                    // In a real app, you'd check if they have markets, products, etc.
                    const gettingStartedCard = document.getElementById('gettingStartedCard');
                    if (gettingStartedCard) {
                        gettingStartedCard.style.display = 'block';
                    }
                }
            }
        }

        // Initialize home controller when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new HomeController();
        });
    </script>

    <style>
        .quick-action-card {
            display: block;
            background: var(--neutral-50);
            border: 1px solid var(--neutral-200);
            border-radius: var(--radius-lg);
            padding: var(--space-6);
            text-decoration: none;
            color: inherit;
            transition: all var(--transition-base);
            text-align: center;
        }

        .quick-action-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-300);
            text-decoration: none;
        }

        .quick-action-icon {
            font-size: var(--text-3xl);
            margin-bottom: var(--space-3);
        }

        .quick-action-card h3 {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--neutral-800);
            margin-bottom: var(--space-2);
        }

        .quick-action-card p {
            font-size: var(--text-sm);
            color: var(--neutral-600);
        }

        .step-card {
            background: var(--neutral-50);
            border: 1px solid var(--neutral-200);
            border-radius: var(--radius-lg);
            padding: var(--space-5);
            text-align: center;
            transition: all var(--transition-base);
        }

        .step-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .step-number {
            width: 3rem;
            height: 3rem;
            background: var(--primary-600);
            color: var(--neutral-50);
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--text-lg);
            font-weight: var(--font-bold);
            margin: 0 auto var(--space-3);
        }

        .step-card h4 {
            font-size: var(--text-base);
            font-weight: var(--font-semibold);
            color: var(--neutral-800);
            margin-bottom: var(--space-2);
        }

        .step-card p {
            font-size: var(--text-sm);
            color: var(--neutral-600);
            margin-bottom: var(--space-3);
        }

        .empty-state-sm {
            text-align: center;
            color: var(--neutral-400);
            padding: var(--space-6);
        }

        .empty-state-sm span {
            font-size: var(--text-3xl);
            display: block;
            margin-bottom: var(--space-3);
        }

        .empty-state-sm p {
            font-size: var(--text-sm);
            margin-bottom: var(--space-3);
        }
    </style>
</body>
</html>